<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spherical Functions · CMB Analysis</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">CMB Analysis</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">CMB.jl Documentation</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../healpix/">HEALPix Pixelization</a></li><li class="is-active"><a class="tocitem" href>Spherical Functions</a><ul class="internal"><li><a class="tocitem" href="#sphere_defn-1"><span>Definitions</span></a></li><li><a class="tocitem" href="#sphere_usage-1"><span>Usage</span></a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../lib/public/">Public</a></li><li><a class="tocitem" href="../../lib/private/">Private</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Spherical Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spherical Functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmert/CMB.jl/blob/master/docs/src/man/sphere.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="man_sphere-1"><a class="docs-heading-anchor" href="#man_sphere-1">Spherical Functions</a><a class="docs-heading-anchor-permalink" href="#man_sphere-1" title="Permalink"></a></h1><ul><li><a href="#man_sphere-1">Spherical Functions</a></li><ul><li><a href="#sphere_defn-1">Definitions</a></li><li><a href="#sphere_usage-1">Usage</a></li></ul></ul><p>A key aspect of computing pixel-pixel covariance is calculating relative orientations of the two pixels on the sphere. The <a href="../../lib/public/#CMB.Sphere"><code>Sphere</code></a> module implements a few basic spherical functions. For HEALPix-specific calculations, see the <a href="../healpix/#man_healpix-1"><code>HEALPix</code> Pixelization</a> documentation instead.</p><h2 id="sphere_defn-1"><a class="docs-heading-anchor" href="#sphere_defn-1">Definitions</a><a class="docs-heading-anchor-permalink" href="#sphere_defn-1" title="Permalink"></a></h2><ul><li><p>A colatitude-azimuth pair <span>$(θ, ϕ)$</span> are coordinates on the sphere measuring the angular distance (in radians) from the North pole and east of the Prime Meridian, respectively. The coordinates will typically be normalized to the range <span>$θ ∈ [0, π]$</span> and <span>$ϕ ∈ [0, 2π)$</span>.</p></li><li><p>A latitude-longitude pair <span>$(δ, λ)$</span> are coordinates on the sphere measuring the angular distance (in degrees) north or south of the Equator and east or west of the Prime Meridian, respectively. The coordinates will typically be normalized to the range <span>$δ ∈ [-90, 90]$</span> and <span>$λ ∈ [-180, 180]$</span>.</p></li><li><p>A Cartesian unit vector <span>$\vec r$</span> centered at the origin of a sphere has its end-point at a location on the unit sphere. The coordinate system is right-handed, with the North Pole located at <span>$\hat z = [0, 0, 1]$</span> and the intersection of the Prime Meridian and Equator located at <span>$\hat x = [1, 0, 0]$</span>.</p></li></ul><p>In general, the function throughout the <code>CMB</code> package will take either colatitude-azimuth or unit vector coordinates.</p><h2 id="sphere_usage-1"><a class="docs-heading-anchor" href="#sphere_usage-1">Usage</a><a class="docs-heading-anchor-permalink" href="#sphere_usage-1" title="Permalink"></a></h2><p>Conversion between colatitude-azimuth pairs, latitude-longitude pairs, and unit vectors can be accomplished via the unexported functions <a href="../../lib/private/#CMB.Sphere.colataz-Tuple{Any,Any}"><code>Sphere.colataz</code></a>, <a href="../../lib/private/#CMB.Sphere.latlon-Tuple{Any,Any}"><code>Sphere.latlon</code></a>, and <a href="../../lib/private/#CMB.Sphere.cartvec-Tuple{Any,Any}"><code>Sphere.cartvec</code></a>.</p><pre><code class="language-julia-repl">julia&gt; using CMB.Sphere

julia&gt; using CMB.Sphere: colataz, latlon, cartvec

julia&gt; δ, λ = 44.97531, -93.23471;  # Tate Lab @ Univ. of Minnesota

julia&gt; θ, ϕ = colataz(δ, λ)         # lat-lon to colat-az
(0.7858290851897657, 4.655932640537504)

julia&gt; latlon(θ, ϕ)                 # colat-az to lat-lon
(44.97531, -93.23471)

julia&gt; r = cartvec(θ, ϕ)            # colat-az to unit vector
3-element StaticArrays.SArray{Tuple{3},Float64,1,3} with indices SOneTo(3):
 -0.03991664732478908
 -0.7062843499648845
  0.7068020078218715

julia&gt; colataz(r)       # unit vector to colat-az
(0.7858290851897657, 4.655932640537504)

julia&gt; latlon(r)        # unit vector to lat-lon
(44.97531000000001, -93.23471000000002)</code></pre><p>Given two points on the sphere — represented as either a unit vector or a colatitude-azimuth pair — we can query for the angular distance between the two points with the <a href="../../lib/public/#CMB.Sphere.distance"><code>distance</code></a> function:</p><pre><code class="language-julia-repl">julia&gt; r₁ = cartvec(colataz(-0.18114, -78.46762)); # Quito, Ecuador

julia&gt; r₂ = cartvec(colataz(69.64906,  18.95454)); # Tromsø, Norway

julia&gt; σ = distance(r₁, r₂)
1.6187031137492613</code></pre><p>In situations where the cosine of the separation is required instead — such as for <a href="https://github.com/jmert/Legendre.jl">Legendre polynomial</a> calculations — it is more efficient to directly return the cosine of the angle with the <a href="../../lib/public/#CMB.Sphere.cosdistance"><code>cosdistance</code></a> function:</p><pre><code class="language-julia-repl">julia&gt; cosdistance(r₁, r₂)
-0.047888464230114274</code></pre><p>The angular separation alone is insufficient for describing the relative orientation of the two points; the orientation angle of the great circle connecting the two must be given with respect to some reference. A common choice is the bearing angle<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. It measures the angle between the meridian (at one of the points) and the great circle connecting the two, as shown by the angle <span>$α_{ij}$</span> in Figure 1.</p><figure><p><img src="../sphereangles.svg" alt="sphere angles"/></p><figcaption style="font-size:smaller; text-align:left; font-style: normal;"><p><strong>Figure 1:</strong> Example showing the angular separation <span>$σ_{ij}$</span> and bearing angle <span>$α_{ij}$</span> between a pair of coordinates <span>$r_i$</span> and <span>$r_j$</span>. The great arc indicates the great circle path passing between both coordinates, and the blue arc is the meridian which passes through <span>$r_i$</span>. Only the bearing angle at <span>$r_i$</span> is shown; a second bearing angle <span>$α_{ji}$</span> at <span>$r_j$</span> also exists (and is in general different that <span>$α_{ij}$</span>) but is not shown. The additional vectors <span>$\hat{n}_i^*$</span> and <span>$\hat{n}_{ij}$</span> are used to derive the distance and bearing angle calculations and can be ignored.</p><p><em>The figure is reproduced from Appendix E of <a href="../references/#bib-bicepkeck-1">J. Willmert</a>.</em></p></figcaption>
</figure><p>The <a href="../../lib/public/#CMB.Sphere.bearing"><code>bearing</code></a> function calculates the bearing angle at the first point for the great circle connecting the pair of points. Continuing with examples using <code>r₁</code> and <code>r₂</code> as defined above,</p><pre><code class="language-julia-repl">julia&gt; α₁ = bearing(r₁, r₂)
0.35250686784416724</code></pre><p>Be careful to remember that the order of coordinates is important! The bearing angle at <code>r₁</code> (in Ecuador near the equator) toward <code>r₂</code> (in northern Norway) is north-northeast as expected. Reversing the coordinates,</p><pre><code class="language-julia-repl">julia&gt; α₂ = bearing(r₂, r₁)
-1.4503517603957734</code></pre><p>the bearing at <code>r₂</code> is almost directly west instead.</p><p>Like with <code>distance</code> and <code>cosdistance</code>, the bearing angle itself is not always necessary, and the instead vector components (cosine and sine of the angle) are sufficient. In such a case, it is more efficient to forego the inverse trigonometric operations and instead use <a href="../../lib/public/#CMB.Sphere.bearing2"><code>bearing2</code></a>:</p><pre><code class="language-julia-repl">julia&gt; δn, δe = bearing2(r₁, r₂)
(0.9385101625713766, 0.34525161078588545)</code></pre><p>For instance, calculating <span>$\cos(2α)$</span> and <span>$\sin(2α)$</span> can be calculated easily a couple of trigonometric identities and is faster.</p><p>The inverse operation is <a href="../../lib/public/#CMB.Sphere.reckon"><code>reckon</code></a> which calculates the coordinate of a point which is a given distance and direction away from a reference point. Given the angular distance <code>σ</code> and bearing <code>α₁</code> from before, we can reconstruct <code>r₂</code>:</p><pre><code class="language-julia-repl">julia&gt; using LinearAlgebra: dot

julia&gt; reckon(r₁, σ, α₁)
3-element StaticArrays.SArray{Tuple{3},Float64,1,3} with indices SOneTo(3):
 0.3289121239720345
 0.11296169792358199
 0.937580113647056

julia&gt; dot(ans, r₂)     # == 1 if ans is parallel to r₂
1.0</code></pre><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>The bearing angle is also sometimes called the azimuth angle, but to   avoid confusion with use of azimuth in colatitude-azimuth coordinates we   will exclusively use the term bearing.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../healpix/">« HEALPix Pixelization</a><a class="docs-footer-nextpage" href="../references/">References »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 8 July 2020 18:08">Wednesday 8 July 2020</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
